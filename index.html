<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Geo Pro Betting System 5.0</title>
<style>
body{font-family:Arial;background:#0f1220;color:#fff;padding:20px}
textarea{width:100%;height:150px;background:#1a1f35;color:#fff;border:1px solid #00ffea;padding:10px}
button{padding:10px 15px;margin-top:10px;background:#00ffea;border:none;font-weight:bold}
.result{background:#1f263d;margin-top:15px;padding:15px;border-left:5px solid #00ffea}
.value{border-left:5px solid #00ff00}
</style>
</head>
<body>

<h2>ðŸ’¥ Geo Pro Betting System 5.0</h2>

<textarea id="inputData" placeholder="Home,Away,Odd1,OddX,Odd2,xGhome,xGaway"></textarea>
<br>
<button onclick="analyze()">RuleazÄƒ analizÄƒ</button>
<button onclick="exportCSV()">Export CSV</button>

<div id="output"></div>

<script>
let finalResults = [];

function poisson(lambda){
    let L=Math.exp(-lambda),p=1,k=0;
    while(p>L){k++;p*=Math.random();}
    return k-1;
}

function simulate(xgH,xgA,sims=100000){
    let h=0,x=0,a=0;
    for(let i=0;i<sims;i++){
        let hg=poisson(xgH);
        let ag=poisson(xgA);
        if(hg>ag)h++;
        else if(hg==ag)x++;
        else a++;
    }
    return {pH:h/sims,pX:x/sims,pA:a/sims};
}

function analyze(){
    const data=document.getElementById("inputData").value.trim().split("\n");
    const output=document.getElementById("output");
    output.innerHTML="";
    finalResults=[];

    data.forEach(line=>{
        if(!line) return;
        const [home,away,o1,oX,o2,xgH,xgA]=line.split(",");
        if(!home||!away) return;

        const sim=simulate(parseFloat(xgH),parseFloat(xgA));
        const edge1=sim.pH*o1-1;
        const edgeX=sim.pX*oX-1;
        const edge2=sim.pA*o2-1;

        const maxEdge=Math.max(edge1,edgeX,edge2);
        if(maxEdge>0){
            let pick="";
            if(maxEdge===edge1) pick=home+" win";
            if(maxEdge===edgeX) pick="Draw";
            if(maxEdge===edge2) pick=away+" win";

            finalResults.push({
                match:home+" vs "+away,
                pick:pick,
                edge:maxEdge.toFixed(3)
            });
        }
    });

    if(finalResults.length===0){
        output.innerHTML="<p>Nu existÄƒ value bet-uri.</p>";
        return;
    }

    finalResults.sort((a,b)=>b.edge-a.edge);

    finalResults.forEach(r=>{
        const div=document.createElement("div");
        div.className="result value";
        div.innerHTML=`<strong>${r.pick}</strong><br>${r.match}<br>Edge: ${r.edge}`;
        output.appendChild(div);
    });
}

function exportCSV(){
    if(finalResults.length===0) return;
    let csv="Match,Pick,Edge\n";
    finalResults.forEach(r=>{
        csv+=`${r.match},${r.pick},${r.edge}\n`;
    });

    const blob=new Blob([csv],{type:"text/csv"});
    const url=URL.createObjectURL(blob);
    const a=document.createElement("a");
    a.href=url;
    a.download="geo_results.csv";
    a.click();
}
</script>

</body>
</html>