<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>Geo Nuclear Quick Pick 4.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
<style>
body {
  font-family: system-ui;
  background: #0f1220;
  color: #00ff9d;
  margin: 0;
  padding: 20px;
}
h2 {text-align:center;}
#matches {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 20px;
}
.match {
  background: #111a33cc;
  padding: 15px;
  border-radius: 10px;
  font-size: 16px;
  color: #ffffff;
}
.match h3 {
  font-size: 24px;
  margin: 0 0 5px 0;
  color: #00ff9d;
}
.match p {
  margin: 2px 0;
  font-size: 14px;
  color: #ffffffaa;
}
input, button {
  padding: 10px;
  margin: 5px;
  font-size: 16px;
}
</style>
</head>
<body>

<h2>ðŸ’¥ Geo Nuclear Quick Pick 4.0 ðŸ’¥</h2>
<input type="file" id="imgInput" accept="image/*">
<button onclick="runOCR()">RuleazÄƒ analizÄƒ</button>

<div id="matches"></div>

<script>
const leagues = {
  "Premier League": ["Arsenal","Aston Villa","Bournemouth","Brentford","Brighton","Chelsea","Crystal Palace","Everton","Fulham","Liverpool","Man City","Man United","Newcastle","Nottingham","Tottenham","West Ham","Wolves","Leicester","Sheffield","Burnley"]
};

// Monte Carlo
function poissonRandom(lambda){let L=Math.exp(-lambda),p=1,k=0;while(p>L){k++;p*=Math.random();}return k-1;}
function monteCarlo(xgH,xgA,sims=100000){
  let cH=0, cX=0, cA=0;
  for(let i=0;i<sims;i++){
    let h=poissonRandom(xgH), a=poissonRandom(xgA);
    if(h>a)cH++; else if(h==a)cX++; else cA++;
  }
  return {pH:cH/sims, pX:cX/sims, pA:cA/sims};
}

// Detectare liga
function detectLeague(text){
  for(let league in leagues){
    for(let team of leagues[league]){
      if(text.toLowerCase().includes(team.toLowerCase())) return league;
    }
  }
  return null;
}

// OCR
function runOCR(){
  let file=document.getElementById("imgInput").files[0];
  if(!file){alert("Alege poza"); return;}
  document.getElementById("matches").innerHTML = "Se proceseazÄƒ OCR...";
  Tesseract.recognize(file,'eng',{logger:m=>console.log(m)})
    .then(({data:{text}})=>{processText(text);});
}

// Procesare text È™i afiÈ™are meciuri cÃ¢È™tigÄƒtoare
function processText(text){
  text = text.replace(/\r/g,' ').replace(/\n/g,' ')
             .replace(/\t/g,' ').replace(/[^\w\s\.\-]/gi,' ')
             .replace(/\s+/g,' ').trim();

  let league = detectLeague(text);
  if(!league){document.getElementById("matches").innerHTML="Nu s-a detectat liga."; return;}
  let teams = leagues[league];
  let added = new Set();
  let matchesDiv = document.getElementById("matches");
  matchesDiv.innerHTML = "";

  // Cautam toate meciurile
  for(let i=0;i<teams.length;i++){
    for(let j=i+1;j<teams.length;j++){
      let t1 = teams[i];
      let t2 = teams[j];
      if(text.toLowerCase().includes(t1.toLowerCase()) && text.toLowerCase().includes(t2.toLowerCase())){
        let key = t1 + "|" + t2;
        if(added.has(key)) continue;
        added.add(key);

        // Cote
        let regexOdds=/(\d+\.\d+)/g;
        let numbers = text.match(regexOdds);
        let odds=[1.5,3.0,2.5];
        if(numbers && numbers.length>=3){
          odds=[parseFloat(numbers[0]),parseFloat(numbers[1]),parseFloat(numbers[2])];
        }

        // xG
        let regexXG=/(\d*\.?\d+)xG/gi;
        let xgMatch=text.match(regexXG);
        let xgH=1.5, xgA=1.5;
        if(xgMatch && xgMatch.length>=1)xgH=parseFloat(xgMatch[0]);
        if(xgMatch && xgMatch.length>=2)xgA=parseFloat(xgMatch[1]);

        // Monte Carlo
        let sim=monteCarlo(xgH,xgA);
        let maxP=Math.max(sim.pH,sim.pX,sim.pA);
        let edge=0;
        if(maxP==sim.pH) edge=(sim.pH*odds[0]-1);
        else if(maxP==sim.pX) edge=(sim.pX*odds[1]-1);
        else edge=(sim.pA*odds[2]-1);

        if(edge>0){
          let pick=maxP==sim.pH?t1:maxP==sim.pX?"Egal":t2;
          // afisare
          let div = document.createElement("div");
          div.className = "match";
          div.innerHTML = `<h3>${pick}</h3><p>Liga: ${league}</p><p>${t1} vs ${t2}</p><p>Cote: ${odds[0]}/${odds[1]}/${odds[2]}</p><p>xG: ${xgH.toFixed(1)}-${xgA.toFixed(1)}</p><p>Edge: ${edge.toFixed(2)}</p>`;
          matchesDiv.appendChild(div);
        }
      }
    }
  }

  if(matchesDiv.children.length==0){
    matchesDiv.innerHTML="Nu sunt meciuri profitabile";
  }
}
</script>

</body>
</html>