<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>OMNISCAN â€“ Crypto + Solana Meme Coins 15m REAL TREND</title>
<script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async></script>
<style>
body { background:#000; color:#0f0; font-family:monospace; padding:10px; }
h1 { color:#0ff; }
.signal { margin-bottom:15px; border-bottom:1px solid #0f0; padding-bottom:5px; }
</style>
</head>
<body>

<h1>OMNISCAN â€“ Crypto + Solana Meme Coins (15m) REAL TREND</h1>
<div id="output">Se analizeazÄƒ piaÈ›a...</div>

<script>
// --- INIT OneSignal ---
window.OneSignal = window.OneSignal || [];
OneSignal.push(function() {
  OneSignal.init({
    appId: "YOUR_REAL_ONESIGNAL_APP_ID",
    notifyButton: { enable:false }
  });
});

// --- Crypto tradiÈ›ional ---
const cryptoSymbols = ["BTCUSDT","ETHUSDT"];

function calculateEMA(data, period){
    const k = 2/(period+1);
    let ema = data[0];
    for(let i=1;i<data.length;i++){
        ema = data[i]*k + ema*(1-k);
    }
    return ema;
}

function calculateRSI(closes, period=14){
    let gains=0, losses=0;
    for(let i=closes.length-period;i<closes.length-1;i++){
        const diff = closes[i+1]-closes[i];
        if(diff>0) gains+=diff;
        else losses-=diff;
    }
    const rs = gains/(losses||1);
    return 100 - (100/(1+rs));
}

async function analyzeCrypto(symbol){
    const url = `https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=15m&limit=100`;
    const res = await fetch(url);
    const data = await res.json();
    const closes = data.map(c=>parseFloat(c[4]));
    const volumes = data.map(c=>parseFloat(c[5]));
    const ema9 = calculateEMA(closes.slice(-9),9);
    const ema21 = calculateEMA(closes.slice(-21),21);
    const rsi = calculateRSI(closes);
    const avgVolume = volumes.slice(0,-1).reduce((a,b)=>a+b)/(volumes.length-1);
    const currentVolume = volumes[volumes.length-1];

    let score=0;
    if(ema9>ema21) score+=30;
    if(rsi>55 && rsi<75) score+=25;
    if(currentVolume>avgVolume*1.5) score+=25;
    if(closes[closes.length-1] > closes[closes.length-5]) score+=20;

    return {symbol, score, ema9, ema21, rsi};
}

// --- Solana Meme Coins ---
async function fetchSolanaTokens(){
    try{
        const res = await fetch('https://api.dexscreener.com/latest/dex/tokens?chain=solana');
        const data = await res.json();
        return data.pairs.slice(0,50).map(t=>({
            name:t.baseToken.name,
            symbol:t.baseToken.symbol,
            price:parseFloat(t.priceUsd),
            prices15m:t.baseToken.priceData15m || [], // array cu ultimele 15 lumÃ¢nÄƒri, dacÄƒ e disponibil
            volume:parseFloat(t.baseToken.dayData.volumeUsd),
            liquidity:parseFloat(t.liquidity)
        }));
    }catch(e){console.error(e); return [];}
}

function analyzeSolanaToken(token){
    let score=0;
    // Trend real 15m: preÈ› constant sau Ã®n creÈ™tere
    if(token.prices15m.length>=5){
        const last5 = token.prices15m.slice(-5);
        let trend = 0;
        for(let i=0;i<last5.length-1;i++){
            if(last5[i+1]>last5[i]) trend+=1;
        }
        score += trend*10; // maxim 40 pct
    }

    if(token.volume > 5000) score+=30; 
    if(token.liquidity > 10000) score+=30; 

    return {...token, score:Math.min(100,score)};
}

// --- RUN SCANNER ---
async function runScanner(){
    const output = document.getElementById("output");
    let signals=[];

    // Crypto tradiÈ›ional
    for(const s of cryptoSymbols){
        try{
            const res = await analyzeCrypto(s);
            if(res.score>=60) signals.push(res);
        }catch(e){console.error(e);}
    }

    // Meme coins Solana
    const solTokens = await fetchSolanaTokens();
    solTokens.forEach(t=>{
        const analyzed = analyzeSolanaToken(t);
        if(analyzed.score>=60) signals.push(analyzed);
    });

    if(signals.length===0){
        output.innerHTML="âš ï¸ Nicio oportunitate validÄƒ â‰¥60% momentan.";
    }else{
        output.innerHTML = signals.map(s=>{
            OneSignal.push(function(){
                OneSignal.sendSelfNotification(
                    `ðŸŒ  Semnal Crypto/Meme: ${s.symbol}`,
                    `Score: ${s.score}%`,
                    'https://i.imgur.com/U4tV8aQ.png',
                    {url: window.location.href}
                );
            });
            return `<div class="signal">ðŸš€ ${s.symbol} | Score: ${s.score}% | Price: ${s.price}</div>`;
        }).join("");
    }
}

runScanner();
setInterval(runScanner,60000);

</script>
</body>
</html>