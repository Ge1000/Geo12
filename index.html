<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Focus</title>

<!-- PWA manifest inline -->
<link rel="manifest" href="data:application/json,{
  &quot;name&quot;:&quot;Focus&quot;,
  &quot;short_name&quot;:&quot;Focus&quot;,
  &quot;start_url&quot;:&quot;.&quot;,
  &quot;display&quot;:&quot;standalone&quot;,
  &quot;background_color&quot;:&quot;#0f1220&quot;,
  &quot;theme_color&quot;:&quot;#0f1220&quot;
}">

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  background:#0f1220;
  color:#fff;
  padding:20px;
  text-align:center;
}
h1{font-size:22px;opacity:.85}
.card{
  background:#1a1f3a;
  padding:20px;
  border-radius:16px;
  margin-top:20px;
}
input,button{
  width:100%;
  padding:14px;
  margin-top:10px;
  border-radius:10px;
  border:none;
  font-size:16px;
}
button{
  background:#3a4bff;
  color:#fff;
  font-weight:700;
}
.row{
  display:flex;
  gap:10px;
  margin-top:10px;
}
.row button{flex:1}
.green{background:#1e7f43}
.red{background:#8b1e1e}
.yellow{background:#b58b00}
.lock{background:#000;color:#ff4d4d}
.small{font-size:13px;opacity:.6;margin-top:10px}
</style>
</head>

<body>

<h1>Focus</h1>

<div class="card" id="setup">
  <input type="number" id="start" placeholder="Valoare inițială">
  <input type="number" id="up" placeholder="Limită superioară">
  <input type="number" id="down" placeholder="Limită inferioară">
  <button onclick="startSession()">Start</button>
</div>

<div class="card" id="session" style="display:none">
  <h2 id="balance">0</h2>

  <div class="row">
    <button onclick="change(5)">+5</button>
    <button onclick="change(10)">+10</button>
    <button onclick="change(20)">+20</button>
  </div>

  <div class="row">
    <button onclick="change(-5)">-5</button>
    <button onclick="change(-10)">-10</button>
    <button onclick="change(-20)">-20</button>
  </div>

  <div id="status" class="card yellow" style="margin-top:15px">
    Monitorizare activă
  </div>
</div>

<p class="small">Datele sunt stocate local pe telefon.</p>

<script>
let startValue=0,value=0,up=0,down=0,locked=false;

function save(){
  localStorage.setItem("focus-data",JSON.stringify({
    startValue,value,up,down,locked
  }));
}

function load(){
  const d=localStorage.getItem("focus-data");
  if(!d)return;
  const o=JSON.parse(d);
  startValue=o.startValue;
  value=o.value;
  up=o.up;
  down=o.down;
  locked=o.locked;
  document.getElementById("setup").style.display="none";
  document.getElementById("session").style.display="block";
  document.getElementById("balance").innerText=value.toFixed(2);
  update();
}

function startSession(){
  startValue=Number(start.value);
  up=Number(document.getElementById("up").value);
  down=Number(document.getElementById("down").value);
  if(!startValue||up<=0||down<=0){alert("Valori invalide");return;}
  value=startValue;
  locked=false;
  document.getElementById("setup").style.display="none";
  document.getElementById("session").style.display="block";
  document.getElementById("balance").innerText=value.toFixed(2);
  update();
  save();
}

function change(a){
  if(locked)return;
  value+=a;
  document.getElementById("balance").innerText=value.toFixed(2);
  update();
  save();
}

function update(){
  const diff=value-startValue;
  const s=document.getElementById("status");
  if(diff>=up){
    lock("Limită superioară atinsă");
  }else if(diff<=-down){
    lock("Limită inferioară atinsă");
  }else{
    s.className="card yellow";
    s.innerText="În parametri";
  }
}

function lock(msg){
  locked=true;
  const s=document.getElementById("status");
  s.className="card lock";
  s.innerHTML=msg+"<br>SESIUNE ÎNCHEIATĂ";
  if(navigator.vibrate)navigator.vibrate([300,200,300]);
  save();
}

load();
</script>

</body>
</html>