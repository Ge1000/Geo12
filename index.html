<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Bet Detector PRO+</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>

<style>
body{
    font-family:system-ui;
    background:#0f1220;
    color:white;
    padding:20px;
}
button{
    padding:10px 20px;
    background:#00c896;
    border:none;
    color:black;
    font-weight:bold;
    cursor:pointer;
    margin-top:10px;
}
input{
    margin-top:15px;
}
.card{
    background:#1a1f35;
    padding:15px;
    margin-top:15px;
    border-radius:10px;
}
.good{ color:#00ff99; }
.warn{ color:#ffaa00; }
</style>
</head>
<body>

<h2>ðŸ”¥ Smart Bet Detector PRO+</h2>

<input type="file" id="imageInput" accept="image/*">
<br>
<button onclick="runOCR()">ScaneazÄƒ</button>

<div id="output"></div>

<script>

function cleanText(text){
    return text
        .replace(/Meci/gi,"")
        .replace(/Egal/gi,"")
        .replace(/\s+/g," ")
        .trim();
}

function parseMatches(text){

    text = cleanText(text);

    const regex = /([A-Za-z\.\s]+?)\s+vs\s+([A-Za-z\.\s]+?)\s+(\d+\.\d+)\s+(\d+\.\d+)\s+(\d+\.\d+)/g;

    let matches = [];
    let match;

    while((match = regex.exec(text)) !== null){
        matches.push({
            home: match[1].trim(),
            away: match[2].trim(),
            odds:[
                parseFloat(match[3]),
                parseFloat(match[4]),
                parseFloat(match[5])
            ]
        });
    }

    return matches;
}

function smartPick(match){

    let [o1,oX,o2] = match.odds;

    let implied1 = 1/o1;
    let impliedX = 1/oX;
    let implied2 = 1/o2;

    let total = implied1 + impliedX + implied2;

    let p1 = implied1/total;
    let pX = impliedX/total;
    let p2 = implied2/total;

    let max = Math.max(p1,pX,p2);
    let confidence = (max*100).toFixed(2);

    let pick;

    if(max === p1) pick = match.home;
    else if(max === p2) pick = match.away;
    else pick = "Egal";

    return {pick,confidence};
}

function render(matches){

    let output = document.getElementById("output");
    output.innerHTML = "<h3>Meciuri Detectate</h3>";

    if(matches.length === 0){
        output.innerHTML += "<p class='warn'>Nu s-au detectat meciuri valide.</p>";
        return;
    }

    matches.forEach(m=>{
        let result = smartPick(m);

        output.innerHTML += `
        <div class="card">
            <strong>${m.home} vs ${m.away}</strong><br>
            Cote: ${m.odds[0]} / ${m.odds[1]} / ${m.odds[2]}<br>
            ðŸ”¥ Recomandare Smart: <span class="good">${result.pick}</span><br>
            Scor Ã®ncredere: ${result.confidence}%
        </div>
        `;
    });
}

async function runOCR(){

    const file = document.getElementById("imageInput").files[0];
    if(!file) return alert("ÃŽncarcÄƒ o imagine.");

    const output = document.getElementById("output");
    output.innerHTML = "Se proceseazÄƒ imaginea...";

    const { data:{ text } } = await Tesseract.recognize(
        file,
        'eng',
        { logger: m => console.log(m) }
    );

    let matches = parseMatches(text);

    render(matches);
}

</script>
</body>
</html>